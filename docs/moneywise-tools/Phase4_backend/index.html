<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Phase4_backend (moneywise-tools.Phase4_backend)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Index</a> &#x00BB; <a href="../index.html">moneywise-tools</a> &#x00BB; Phase4_backend</nav><header class="odoc-preamble"><h1>Module <code><span>Phase4_backend</span></code></h1><p>Step to migrate backend/setup.sh:</p><ul><li>Step 1: (independent)</li></ul><ol><li>Check `Cargo.toml`</li><li>Check `.env`: if it is missing, check for `.env.example`. if `.env.example` exists, copy it to `.env`</li></ol><ul><li>Step 2: Environment Parsing and Database Detection (depend on step 1)</li></ul><ol><li>Read the `.env` to understand about the database environment</li><li>Parse `.env` and get the `DATABASE_URL`</li><li>Detech database type: localhost, or supabase?</li></ol><ul><li>Step 3: Core Build and Migration (depend on 2)</li></ul><ol><li>Install SQLx CLI: check `sqlx` command is available. If not install it.</li><li>Run Database Migrations: `sqlx migrate run` within the backend folder.</li><li>Build the project: `cargo build` in the backend folder.</li></ol><p>----- Service and Database Management These steps handle the &quot;stateful&quot; parts of the environment, such as runnning services, verifying the database state. They can be implemented after the core logic is working.</p><ul><li>Step 4: Local Service Management (Depend on step 2)</li></ul><ol><li>Condition Execution: only run this step if the database type from Step 2 is `local`</li><li>Start PostgreSQL: Execute the system command to start the PostgreSQL service.</li><li>Start Redis: Execute the system command to start the Redis service.</li></ol><ul><li>Step 5: Database Verification (Depend on step 3 and 4) Perfom checks to ensure the database is correctly set up and the connection is working.</li></ul><ol><li>Test connection: ++ For `Supabase`, verify the connection to the remote database. ++ For `Local`, verify the connection to the local PostgreSQL instance.</li><li>Verify Schema: Implement a basic schema check (e.g., query for the existence of a key table created by the migrations.) Depend on step 3, and for a local setup, the service must be running (step 4)</li></ol><p>---- Post-Setup Enhancements</p><p>This final setp is a &quot;nice-to-have&quot; that confirms the running application is working correctly.</p><p>Step 6: Live Server Health Check (Depend on step 3) Briefly start the backend server and test its main API endpoints to confirm the build was successful and the server can run.</p><ol><li>Start Server: Run `cargo run`</li><li>Health Check: After a short delay, use an OCaml HTTP client library to make requests to `http://localhost:3000/api/bugets/overview` and other key endpoints.</li><li>Stop Server: Terminate the background server process after the checks are complete.</li></ol></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-setup_backend"><a href="#val-setup_backend" class="anchor"></a><code><span><span class="keyword">val</span> setup_backend : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="../Types/index.html#type-phase_result">Types.phase_result</a></span></code></div></div></div></body></html>
